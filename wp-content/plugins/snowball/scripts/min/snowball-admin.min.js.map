{"version":3,"sources":["snowball-admin.js"],"names":["debounce","fn","delay","timer","context","this","args","arguments","clearTimeout","setTimeout","apply","$","setHandlers","on","attr","snowball","status","actions","push","action","type","changesMade","title","val","each","trigger","css","parent","width","fixedsticky","data","addBlock","unsavedChanges","tag","removeClass","addClass","filter","click","dialog","next","editor","find","toggleClass","length","hasClass","elem","get","CodeMirror","fromTextArea","mode","name","htmlMode","lineNumbers","lineWrapping","indentUnit","tabSize","theme","closest","getValue","toggle","block","renderPreview","height","refreshEditors","confirmDelete","copyBlock","zoomPreview","retrieveNonReadOnlyText","index","refresh","prepend","append","initEditors","sortable","axis","cancel","change","containment","cursor","tolerance","e","keyCode","window","resize","logger","populateSavedBlocks","b","savedblocks","toLowerCase","at","blockCode","blocks","names","text","end","key","hasOwnProperty","selector","input","value","is","prop","customCss","html","dataBlock","blockType","load","wpColorPicker","event","appendTo","insertAfter","eq","preview","contents","templates","fields","element","target","replace","regex","RegExp","author","blogname","blogurl","date","url","$html","blockScripts","detach","empty","previewScripts","callback","i","script","iframe","contentDocument","createElement","src","defaultScripts","onload","callback2","head","appendChild","innerHTML","body","style","cm","defaultCss","pluginsUrl","includesUrl","cssEditor","customStyle","data-type","scoped","defaultStylesheets","forEach","href","code","zoom","scale","-webkit-transform","transform","editors","modeType","isReadOnly","readOnly","renderEditor","cssCode","split","nonReadOnlyCode","clone","remove","cursorPos","getCursor","scrollPos","getScrollInfo","top","startLine","line","ch","endLine","options","inclusiveLeft","setValue","markText","addLineClass","setCursor","scrollTo","readOnlyMark","getAllMarks","mark","lastReadOnlyLine","lines","fromLine","toLine","lastLine","getRange","parseBlock","htmlEditor","result","confirm","article","headEditor","Parse","initialize","serverURL","Blocks","Object","extend","save","postid","id","authorLogin","user","userLogin","size","jQuery","document","ready","JSON","parse"],"mappings":"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","file":"snowball-admin.min.js","sourcesContent":["(function($) {\n  var changesMade = false;\n  var actions = [];\n  snowball.status = $(\"#save-post\").length === 0 ? \"publish\" : \"draft\";\n\n  jQuery(document).ready(function() {\n    if ((snowball.savedblocks.length !== 0) && (snowball.savedblocks !== \"null\")) {\n      $(\"#snowball_meta\").removeClass(\"closed\");\n\n      snowball.savedblocks = JSON.parse(snowball.savedblocks);\n      populateSavedBlocks();\n    } else {\n      snowball.savedblocks = [];\n    }\n\n    setHandlers();\n  });\n\n  function setHandlers() {\n    $(\"#publish, #save-post\").on(\"click\", function() {\n      if ($(this).attr(\"id\") == \"publish\") {\n        snowball.status = \"publish\";\n        actions.push({\n          action: \"save\",\n          type: \"publish\"\n        });\n      } else {\n        snowball.status = \"draft\";\n        actions.push({\n          action: \"save\",\n          type: \"draft\"\n        });\n      }\n\n      changesMade = false;\n    });\n\n    $(\"#title\").on(\"input\", debounce(function() {\n      snowball.title = $(this).val();\n      $(\".snowball-block\").each(function() {\n        $(this).trigger(\"render\");\n      });\n    }, 250));\n\n    $(\"#snowball-toolbar\")\n      .css(\"width\", $(\"#snowball-toolbar\").parent().width())\n      .fixedsticky();\n\n    $(\"#snowball-toolbar .block-button\").on(\"click\", function() {\n      var type = $(this).data(\"type\");\n      addBlock(type);\n      unsavedChanges();\n\n      actions.push({\n        action: \"add\",\n        type: type\n      });\n    });\n\n    $(\"#snowball-toolbar .tag\").on(\"click\", function() {\n      var tag = $(this).attr(\"data-tag\");\n      $(\".tag.active\").removeClass(\"active\");\n      $(this).addClass(\"active\");\n\n      if (tag === \"all\") {\n        $(\"#snowball-toolbar .buttons .button\").removeClass(\"hidden\");\n      } else {\n        $(\"#snowball-toolbar .buttons .button\").addClass(\"hidden\").filter(\".\" + tag).removeClass(\"hidden\");\n      }\n    });\n\n    $(\"#snowball-toolbar .settings .button\").on(\"click\", function() {\n      var click = $(this).attr(\"data-click\");\n      $(click).click();\n    });\n\n    $(\"#snowball-toolbar .menu-toggle\").on(\"click\", function() {\n      var dialog = $(this).next(\".dialog\");\n      var editor = dialog.find(\".CodeMirror\");\n\n      dialog.addClass(\"modal\");\n      $(\"body\").toggleClass(\"modal\");\n\n      if ((editor.length === 0) && dialog.hasClass(\"settings-dropdown\")) {\n        var elem = dialog.find(\"textarea\").get(0);\n        editor = CodeMirror.fromTextArea(elem, {\n            mode: {name: \"htmlmixed\", htmlMode: true},\n            lineNumbers: true,\n            lineWrapping: true,\n            indentUnit: 2,\n            tabSize: 2,\n            theme: \"monokai\"\n        });\n      }\n\n    });\n\n    $(\"#snowball-toolbar .menu .close\").on(\"click\", function() {\n      var dialog = $(this).closest(\".dialog\");\n      var css = dialog.find(\".CodeMirror\")[0].CodeMirror.getValue();\n\n      if (css) {\n        actions.push({\n          action: \"code\",\n          type: \"head\",\n          data: css\n        });\n      }\n\n      dialog.removeClass(\"modal\");\n      $(\"body\").removeClass(\"modal\");\n    });\n\n    $(\"#snowball-settings .toggle\").on(\"click\", function() {\n      $(\"#snowball-settings ul\").toggle();\n    });\n\n    $(\"#snowball-main\")\n      .on(\"render\", \".snowball-block\", function() {\n        var block = $(this);\n        renderPreview(block);\n      })\n      .on(\"mousedown\", \".snowball-block\", function() {\n        $(\"#snowball-main\").height($(\"#snowball-main\").height());\n      })\n      .on(\"mouseup\", \".snowball-block\", function() {\n        $(\"#snowball-main\").height(\"auto\");\n      })\n      .on(\"input change paste\", \".snowball-tinker input, .snowball-tinker textarea, .snowball-tinker select\", debounce(function() {\n        var block = $(this).closest(\".snowball-block\");\n        block.trigger(\"render\");\n        refreshEditors(block);\n        unsavedChanges();\n      }, 250))\n      .on(\"click\", \".snowball-delete\", function() {\n        var block = $(this).closest(\".snowball-block\");\n        var type = block.data(\"type\");\n\n        confirmDelete(block);\n      })\n      .on(\"click\", \".snowball-copy\", function() {\n        var block = $(this).closest(\".snowball-block\");\n        var type = block.data(\"type\");\n\n        copyBlock(block);\n        unsavedChanges();\n\n        actions.push({\n          action: \"copy\",\n          type: type\n        });\n      })\n      .on(\"click\", \".snowball-zoom-toggle\", function() {\n        var block = $(this).closest(\".snowball-block\");\n        var type = block.data(\"type\");\n\n        block.find(\".snowball-code, .snowball-copy, .snowball-delete, .snowball-top, .snowball-bottom\").toggle();\n\n        block.toggleClass(\"modal\");\n        $(\"body\").toggleClass(\"modal\");\n        zoomPreview(block);\n\n        if (!block.hasClass(\"modal\")) {\n          var editor = block.find(\".snowball-css .CodeMirror\")[0].CodeMirror;\n          var css = retrieveNonReadOnlyText(editor);\n\n          actions.push({\n            action: \"code\",\n            type: type,\n            data: css\n          });\n        }\n\n        block.find(\".CodeMirror\").each(function(index, editor) {\n          editor.CodeMirror.refresh();\n        });\n      })\n      .on(\"click\", \".snowball-top\", function() {\n        var block = $(this).closest(\".snowball-block\");\n\n        if (block.index() > 0) {\n          block.parent().prepend(block);\n          unsavedChanges();\n        }\n      })\n      .on(\"click\", \".snowball-bottom\", function() {\n        var block = $(this).closest(\".snowball-block\");\n\n        if (block.index() < ($(\".snowball-block\").length) - 1) {\n          block.parent().append(block);\n          unsavedChanges();\n        }\n      })\n      .on(\"mouseover\", \".snowball-zoom-toggle\", function() {\n        var block = $(this).closest(\".snowball-block\");\n\n        if (block.find(\".snowball-code .CodeMirror\").length === 0) {\n          initEditors(block);\n        }\n      })\n      .on(\"change\", \".handsontable\", function() {\n        unsavedChanges();\n      })\n      .sortable({\n        axis: \"y\",\n        cancel: \".snowball-block.modal, .snowball-title-button, button, textarea, input, select, .handsontable .wtHider, .CodeMirror, .button, .toggle-buttons\",\n        change: function() {\n          unsavedChanges();\n        },\n        containment: \"#snowball-main\",\n        cursor: \"move\",\n        tolerance: \"pointer\"\n      });\n\n    $(\"body\")\n      .on(\"click\", \"#modal-bg\", function() {\n        $(\".snowball-block.modal .snowball-zoom-toggle, .settings-dropdown.modal .close\").click();\n        $(\".modal\").removeClass(\"modal\");\n      })\n      .on(\"keydown\", function (e) {\n        if (e.keyCode === 27) { // ESC\n          $(\".snowball-block.modal .snowball-zoom-toggle, .settings-dropdown.modal .close\").click();\n          $(\".modal\").removeClass(\"modal\");\n        }\n      });\n\n    $(window)\n      .resize(debounce(function() {\n        zoomPreview();\n        $(\".fixedsticky\").fixedsticky(\"destroy\").fixedsticky();\n      }, 250))\n      .resize(function() {\n        var fixedsticky = $(\".fixedsticky\");\n        fixedsticky.css(\"width\", fixedsticky.parent().width());\n      })\n      .on(\"load\", function() {\n        $(\".fixedsticky\").fixedsticky(\"destroy\").fixedsticky();\n      })\n      .on(\"beforeunload\", function(e) {\n        logger();\n\n        if (changesMade) {\n          return \"You may have unsaved changes.\";\n        }\n      });\n\n    $(\"#collapse-menu\").click(function() {\n      var fixedsticky = $(\".fixedsticky\");\n      fixedsticky.css(\"width\", fixedsticky.parent().width());\n      zoomPreview();\n    });\n\n    $(\".hndle, #adv-settings input, .columns-prefs input\").on(\"click\", function() {\n      var fixedsticky = $(\".fixedsticky\");\n      fixedsticky.css(\"width\", fixedsticky.parent().width());\n      fixedsticky.fixedsticky(\"destroy\").fixedsticky();\n    });\n\n    $(\"#show-settings-link\").on(\"click\", function() {\n      setTimeout(function() {\n        $(\".fixedsticky\").fixedsticky(\"destroy\").fixedsticky();\n      }, 200);\n    });\n  }\n\n  function populateSavedBlocks() {\n    for (var b in snowball.savedblocks) {\n      var block = snowball.savedblocks[b];\n      var type = block[\"blockType\"].toLowerCase();\n      // need to delete so snowball.addBlock works properly\n      delete block[\"blockType\"];\n      delete block[\"orderNumber\"];\n\n      addBlock(type, block);\n    }\n  }\n\n  function addBlock(type, data, at) {\n    var blockCode = snowball.blocks[type];\n    var name = snowball.names[type];\n    var block = $(\"<div class='snowball-block'>\" +\n                    \"<div class='snowball-gui'>\" +\n                      \"<div class='snowball-tinker'>\" +\n                        \"<div>\" +\n                          \"<div class='snowball-title'></div>\" +\n                          \"<div class='snowball-title-button-group'>\" +\n                            \"<div class='snowball-title-button snowball-copy' title='Copy block'><i class='fa fa-files-o'></i></div>\" +\n                            \"<div class='snowball-title-button snowball-delete' title='Delete block'>&times;</div>\" +\n                          \"</div>\" +\n                          \"<div class='snowball-title-button-group'>\" +\n                            \"<div class='snowball-title-button snowball-top' title='Move block to top'><i class='fa fa-angle-double-up'></i></div>\" +\n                            \"<div class='snowball-title-button snowball-bottom' title='Move block to bottom'><i class='fa fa-angle-double-down'></i></div>\" +\n                          \"</div>\" +\n                          \"<div class='snowball-title-button-group'>\" +\n                            \"<div class='snowball-title-button snowball-zoom-toggle' title='Edit code'><i class='fa fa-code'></i></div>\" +\n                          \"</div>\" +\n                        \"</div>\" +\n                      \"</div>\" +\n                      \"<iframe class='snowball-preview'></iframe>\" +\n                    \"</div>\" +\n                    \"<div class='snowball-code'>\" +\n                      \"<div class='snowball-html snowball-editor'>\" +\n                        \"<div class='snowball-code-title'>HTML</div>\" +\n                        \"<textarea class='snowball-editor-box' data-mode='xml'></textarea>\" +\n                      \"</div>\" +\n                      \"<div class='snowball-css snowball-editor'>\" +\n                        \"<div class='snowball-code-title'>CSS</div>\" +\n                        \"<textarea class='snowball-editor-box' data-mode='css'></textarea>\" +\n                      \"</div>\" +\n                    \"</div>\" +\n                  \"</div>\");\n\n    block\n      .addClass(\"snowball-block-\" + type)\n      .attr(\"data-type\", type)\n      .attr(\"data-name\", name)\n      .find(\".snowball-title\").text(name).end()\n      .find(\".snowball-tinker\").append(blockCode).end();\n\n    if (data) {\n      for (var key in data) {\n        if (data.hasOwnProperty(key)) {\n          var selector = \"[data-target='\" + key + \"']\";\n          var input = block.find(selector);\n          var value = data[key];\n          if (input) {\n            if (input.is(\":radio\")) {\n              input.filter(\"[value='\" +  value + \"']\").prop(\"checked\", true);\n            } else if (input.is(\":checkbox\")) {\n              input.prop(\"checked\", ((value == \"true\") || value === true));\n            } else {\n              input.val(value);\n            }\n          }\n        }\n\n        if (data.customCss) {\n          block.find(\"textarea[data-mode='css']\").html(data.customCss);\n        }\n      }\n\n\n    } else {\n      var dataBlock = {\n        blockType: type\n      };\n\n      snowball.savedblocks.push(dataBlock);\n    }\n\n    block\n      .find(\".snowball-preview\").load(function() {\n        renderPreview(block);\n      }).end()\n      .find(\".wp-color-picker\").wpColorPicker({\n        change: debounce(function (event) {\n          $(this)\n            .trigger(\"change\")\n            .attr(\"value\", $(this).val());\n        }, 250)\n      });\n\n    if (typeof at == \"undefined\") {\n      block.appendTo(\"#snowball-main\");\n    } else {\n      block.insertAfter($(\".snowball-block\").eq(at));\n    }\n    \n    zoomPreview(block);\n    block.trigger(\"open\");\n  }\n\n  function renderPreview(block) {\n    var type = block.data(\"type\");\n    var preview = block.find(\".snowball-preview\").contents();\n    var html = snowball.templates[type];\n    var selector = \"input[type='text'][data-target], input[type='email'][data-target], input[type='range'][data-target], input[type='hidden'][data-target], input[type='radio'][data-target]:checked, input[type='checkbox'][data-target]:checked, textarea[data-target], select[data-target]\";\n    var fields = block.find(selector);\n\n    fields.each(function(index, element) {\n      var target = $(this).data(\"target\");\n      var value = $(this).val();\n\n      if ((type === \"text\") && $(this).is(\"textarea\")) {\n        // For text blocks, replace \\n\\n with <p>\n        value = value.replace(/\\n([ \\t]*\\n)+/g, '</p><p>')\n                 .replace(/\\n/g, '<br />')\n                 .replace(/<\\/p><p>/g, '</p>\\n\\t<p>');\n      }\n      var regex = new RegExp(\"{{\" + target + \"}}\", \"g\");\n      html = html.replace(regex, value);\n    });\n\n    html = html.replace(/{{.+}}/g, \"\");\n\n    html = html.replace(/\\[author\\]/g, snowball.author)\n               .replace(/\\[blogname\\]/g, snowball.blogname)\n               .replace(/\\[blogurl\\]/g, snowball.blogurl)\n               .replace(/\\[date\\]/g, snowball.date)\n               .replace(/\\[url\\]/g, snowball.url);\n\n    if (snowball.title) {\n      html = html.replace(/\\[title\\]/g, snowball.title);\n    }\n\n    var $html = $(html);\n    var blockScripts = $html.find(\"script\").detach();\n\n    preview.find(\"body\").empty().append($html);\n    previewScripts(blockScripts, block);\n\n    if (block.width()) {\n      zoomPreview(block);\n    }\n\n    block.trigger(\"rendered\");\n  }\n\n  // create script elements from iframe document so js is executed in iframe's context\n  // append default scripts to head so they aren't repeated in article for each block\n  // append block scripts to body so they are included in article\n  // only block scripts with src are re-appended here\n  // block scripts with innerhtml must be evaled in snowball-preview.js\n\n  function previewScripts(blockScripts, block) {\n    var iframe = block.find(\".snowball-preview\");\n    var preview = iframe.contents();\n    var head = preview.find(\"head\");\n    var body = preview.find(\"body\");\n    var cm = block.find('.snowball-code .CodeMirror');\n    var defaultCss = \"\";\n\n    var pluginsUrl = snowball.pluginsUrl;\n    var includesUrl = snowball.includesUrl;\n\n    var style;\n\n    if (cm.length) {\n      var cssEditor = cm[1].CodeMirror;\n      style = retrieveNonReadOnlyText(cssEditor);\n    } else {\n      style = block.find(\"textarea[data-mode='css']\").html();\n    }\n\n    if (style) {\n      var customStyle = $(\"<style></style>\").attr({\"data-type\": \"custom\", \"scoped\": \"scoped\"});\n      customStyle.html(style);\n      body.find(\".snowball-block\").append(customStyle);\n    }\n\n    var defaultStylesheets = [\n                                pluginsUrl + \"/lib/d3-geomap/css/d3.geomap.css\",\n                                pluginsUrl + \"/lib/font-awesome/css/font-awesome.min.css\",\n                                pluginsUrl + \"/styles/min/snowball.min.css\",\n                                pluginsUrl + \"/styles/min/snowball-theme.min.css\",\n                                pluginsUrl + \"/styles/min/snowball-preview.min.css\"\n                              ];\n\n    var defaultScripts = [\n                            includesUrl + \"js/jquery/jquery.js\",\n                            \"https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js\",\n                            \"https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js\",\n                            pluginsUrl + \"/lib/d3-geomap/vendor/d3.geomap.dependencies.min.js\",\n                            pluginsUrl + \"/lib/d3-geomap/js/d3.geomap.min.js\",\n                            pluginsUrl + \"/scripts/min/snowball-preview.min.js\",\n                            pluginsUrl + \"/scripts/min/templates.min.js\"\n                          ];\n\n    defaultStylesheets.forEach(function(href) {\n      var code = \"<link rel='stylesheet' href='\" + href + \"'>\\n\";\n      defaultCss = defaultCss + code;\n    });\n\n    if(head.is(\":empty\")) {\n      head.html(\"<meta charset='utf-8'>\");\n      head.append(defaultCss);\n      head.append($(\"#snowball-custom-code\").val());\n      callback(0);\n    } else {\n      callback2(0);\n    }\n\n    function callback(i) {\n      var script = iframe.get(0).contentDocument.createElement(\"script\");\n      script.src = defaultScripts[i];\n\n      if (i < defaultScripts.length - 1) {\n        script.onload = function() {\n          callback(i+1);\n        };\n      } else {\n        script.onload = function() {\n          callback2(0);\n        };\n      }\n\n      head[0].appendChild(script);\n    }\n\n    function callback2(i) {\n      if (i < blockScripts.length) {\n        var src = blockScripts.eq(i).attr(\"src\");\n        var script = iframe.get(0).contentDocument.createElement(\"script\");\n\n        if (src) {\n          script.src = src;\n          script.onload = function() {\n            callback2(i+1);\n          };\n        } else {\n          script.innerHTML = blockScripts.eq(i).html();\n        }\n\n        body.find(\".snowball-block\").get(0).appendChild(script);\n      }\n    }\n  }\n\n  function zoomPreview(block) {\n    var width;\n    var zoom;\n    var scale;\n\n    if (block) {\n      width = block.width() / 2;\n      zoom = (width < 800) ? width/800 : 1;\n      scale = \"scale(\" + zoom + \")\";\n\n      block.find(\".snowball-preview\").contents().find(\"html\").css({\"-webkit-transform\": scale, \"transform\": scale});\n    } else {\n      $(\".snowball-preview\").each(function() {\n        width = $(this).closest(\".snowball-block\").width() / 2;\n        zoom = (width < 800) ? width/800 : 1;\n        scale = \"scale(\" + zoom + \")\";\n\n        $(this).contents().find(\"html\").css({\"-webkit-transform\": scale, \"transform\": scale});\n      });\n    }\n  }\n\n  function initEditors(block) {\n    var preview = block.find(\".snowball-preview\").contents().find(\"body\");\n    var editors = block.find(\".snowball-editor-box\");\n\n    editors.each(function(index, elem) {\n      var modeType = $(elem).attr(\"data-mode\");\n      var isReadOnly = (modeType === \"xml\") ? true : false;\n\n      var editor = CodeMirror.fromTextArea(elem, {\n          mode: {name: modeType, htmlMode: true},\n          readOnly: isReadOnly,\n          lineNumbers: true,\n          lineWrapping: true,\n          indentUnit: 2,\n          tabSize: 2,\n          theme: \"monokai\"\n      });\n\n      renderEditor(preview, modeType, editor);\n\n      editor.on(\"change\", debounce(function() {\n        var block = $(elem).closest(\".snowball-block\");\n        renderPreview(block);\n        unsavedChanges();\n      }, 250));\n\n    });\n  }\n\n  function renderEditor(preview, modeType, editor, cssCode) {\n    var code = \"\";\n    var length = 0;\n    if (modeType == \"css\") {\n      preview.find(\"style:not([data-type='custom'])\").each(function() {\n        code = code + $(this).html();\n      });\n      // code = preview.find(\"style:not([data-type='custom'])\").html();\n\n      if (code) {\n        code = code.replace(/^\\n+|\\n+$/g, '');\n        code = code + \"\\n\\n\";\n        length = code.split(/\\r\\n|\\r|\\n/).length - 1;\n      } else {\n        code = \"\";\n      }\n\n      if (cssCode) {\n        code = code + cssCode;\n      }\n\n      var nonReadOnlyCode = retrieveNonReadOnlyText(editor);\n      if (nonReadOnlyCode) {\n        code = code + nonReadOnlyCode;\n      }\n    } else if (modeType === \"xml\") {\n      var clone = preview.clone();\n      clone.find(\"style\").remove();\n      code = clone.html().replace(\"\\n\\n</section>\", \"\\n</section>\");\n      length = code.split(/\\r\\n|\\r|\\n/).length;\n    }\n\n    var cursorPos = editor.getCursor();\n    var scrollPos = editor.getScrollInfo().top;\n    var startLine = {line: 0, ch: 0};\n    var endLine = {line: length, ch: 0};\n    var options = {readOnly: true, inclusiveLeft: true};\n\n    editor.setValue(code);\n    editor.markText(startLine, endLine, options);\n\n    for (var i = 0; i < length; i++) {\n      editor.addLineClass(i, \"background\", \"readonly\");\n    }\n\n    editor.setCursor(cursorPos);\n    editor.scrollTo(null, scrollPos);\n  }\n\n  function retrieveNonReadOnlyText(editor) {\n    // there should only be one marked text object in editor.getAllMarks()\n    var readOnlyMark = editor.getAllMarks();\n    var code = editor.getValue();\n\n    if (readOnlyMark.length) {\n      var mark = readOnlyMark[0];\n      var lastReadOnlyLine = mark.lines.length;\n\n      if (lastReadOnlyLine < 2) {\n        code = editor.getValue();\n      } else {\n        var fromLine = {line:lastReadOnlyLine-1, ch:0};\n        var toLine = {line:editor.lastLine()+1, ch:0};\n        code = editor.getRange(fromLine, toLine);\n      }\n    }\n\n    return code;\n  }\n\n  function copyBlock(block) {\n    var type = block.data(\"type\");\n    var data = parseBlock(block);\n    var index = block.index();\n\n    if (data) {\n      addBlock(type, data, index);\n    }\n  }\n\n  function refreshEditors(block) {\n    var cm = block.find('.snowball-code .CodeMirror');\n\n    if (cm.length) {\n      var htmlEditor = cm[0].CodeMirror;\n      var cssEditor = cm[1].CodeMirror;\n      var preview = block.find(\".snowball-preview\").contents().find(\"body\");\n      renderEditor(preview, \"xml\", htmlEditor);\n      renderEditor(preview, \"css\", cssEditor);\n    }\n  }\n\n  function confirmDelete(block) {\n    var result = confirm(\"Are you sure you want to delete this block?\");\n    if (result) {\n      var type = block.data(\"type\");\n      \n      block\n        .trigger(\"close\")\n        .remove();\n\n      unsavedChanges();\n\n      actions.push({\n        action: \"delete\",\n        type: type\n      });\n    }\n  }\n\n  function unsavedChanges() {\n    changesMade = true;\n    $(\"#snowball-toolbar .settings .draft, #snowball-toolbar .settings .save\").addClass(\"unsaved\");\n  }\n\n  function logger() {\n    var article = [];\n    var html = [];\n    var css = [];\n    var head;\n    var headEditor = $(\".settings-dropdown .CodeMirror\");\n\n    if (headEditor.length > 0) {\n      head = headEditor[0].CodeMirror.getValue();\n    } else {\n      head = $(\"#snowball-custom-code\").val();\n    }\n\n    $(\".snowball-block\").each(function() {\n      var block = $(this);\n      var type = block.data(\"type\");\n      var cssEditor = block.find(\".snowball-css .CodeMirror\");\n      var cssCode;\n\n      article.push(type);\n\n      if (cssEditor.length > 0) {\n        cssCode = retrieveNonReadOnlyText(cssEditor[0].CodeMirror);\n      } else {\n        cssCode = block.find(\".snowball-editor-box\").val();\n      }\n\n      css.push({\n        \"type\": type,\n        \"code\": cssCode\n      });\n\n      if (type === \"html\") {\n        var code = block.find(\".snowball-tinker .CodeMirror\")[0].CodeMirror.getValue();\n        html.push(code);\n      }\n    });\n\n    Parse.initialize(\"FwVMmzHookZZ5j9F9ILc2E5MT5ufabuV7hCXKSeu\");\n    Parse.serverURL = 'http://129.25.12.218:1337/parse';\n    var Blocks = Parse.Object.extend(\"Snowball\");\n    var blocks = new Blocks();\n\n    blocks.save({\n      'blogname': snowball.blogname,\n      'blogurl':  snowball.blogurl,\n      'url':      snowball.url,\n      'postid':   snowball.id,\n      'status':   snowball.status,\n      'author':   snowball.authorLogin,\n      'user':     snowball.userLogin,\n      'article':  article,\n      'size':     article.length,\n      'actions':  actions,\n      'head':     head,\n      'css':      css,\n      'html':     html\n    });\n\n    actions = [];\n  }\n\n})(jQuery);\n\n\n\nfunction debounce(fn, delay) {\n  var timer = null;\n  return function () {\n    var context = this, args = arguments;\n    clearTimeout(timer);\n    timer = setTimeout(function () {\n      fn.apply(context, args);\n    }, delay);\n  };\n}\n"]}
function parseBlock(e){var t=e.data("type"),a="input[type='text'][data-target], input[type='email'][data-target], input[type='range'][data-target], input[type='hidden'][data-target], input[type='radio'][data-target]:checked, input[type='checkbox'][data-target], textarea[data-target], select[data-target]",o=e.find(".snowball-tinker form").first().find(a),n={};return o&&(n.blockType=t,o.each(function(e,t){var a=jQuery(t).attr("data-target"),o=jQuery(t).val();"checkbox"==jQuery(t).attr("type")&&(o=!!jQuery(t).is(":checked")),n[a]=o}),n.customCss=retrieveCustomCss(e)),n}function retrieveCustomCss(e){var t,a=e.find(".snowball-code .CodeMirror");if(0===a.length)t=e.find("textarea[data-mode='css']").html();else{var o=a[1].CodeMirror,n=o.getAllMarks();if(t=o.getValue(),n.length){var r=n[0],i=r.lines.length;if(i<2)t=o.getValue();else{var c={line:i-1,ch:0},l={line:o.lastLine()+1,ch:0};t=o.getRange(c,l)}}}return t}jQuery(document).ready(function(e){function t(){var t=1;return e("#theme_option").is(":checked")&&(t=0),t}function a(){var t=e("#snowball-custom-code").val(),a=e("#snowball-custom-code + .CodeMirror").get(0);return a&&(t=a.CodeMirror.getValue()),t}function o(){var t=[];return e(".snowball-block").each(function(){var a=parseBlock(e(this));t.push(a)}),t}function n(){var e="";return jQuery(".snowball-preview").each(function(t,a){var o=jQuery(a).contents().find("body").clone();o.find("svg").remove(),e=e+"\n"+o.html(),o.remove()}),e}e("#publish, #save-post").one("click",function(r){r.preventDefault();var i=e(this),c=o(),l=n(),s={action:"add_blocks",blocks:c,post_id:ajax_object.post_id,snowball_ajax_nonce:ajax_object.snowball_ajax_nonce},u={action:"add_article",article:l,head_html:a(),theme_option:t(),post_id:ajax_object.post_id,is_preview:"false",snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};e.post(ajax_object.ajax_url,u),e.post(ajax_object.ajax_url,s,function(){i.trigger("click")})}),e("#post-preview").click(function(){var a=n(),o={action:"add_article",article:a,theme_option:t(),post_id:ajax_object.post_id,is_preview:"true",snowball_ajax_nonce:ajax_object.snowball_ajax_nonce};e.post(ajax_object.ajax_url,o)})});
//# sourceMappingURL=snowball-ajax.min.js.map

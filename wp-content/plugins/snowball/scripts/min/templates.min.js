function drawBargraph(t){var a=t.find(".json").val(),e=t.find(".chart").get(0),n=t.find(".chart").attr("data-fill"),o=t.find(".spacing").val(),r=JSON.parse(a),l={top:40,right:40,bottom:60,left:30},i=800-l.left-l.right,s=400-l.top-l.bottom,c=d3.scale.ordinal().rangeRoundBands([0,i],o),d=d3.scale.linear().range([s,0]),p=d3.svg.axis().scale(c).orient("bottom"),f=d3.svg.axis().scale(d).orient("left").ticks(10),u=d3.select(e).append("svg").attr("width",i+l.left+l.right).attr("height",s+l.top+l.bottom).append("g").attr("transform","translate("+l.left+","+l.top+")");c.domain(r.map(function(t){return t.label})),d.domain([0,d3.max(r,function(t){return t.value})]),u.append("g").attr("class","x axis").attr("transform","translate(0,"+s+")").call(p),u.append("g").attr("class","y axis").call(f),u.selectAll("path, line").style("fill","none").style("stroke","black"),u.selectAll("bar").data(r).enter().append("rect").style("fill",n).attr("x",function(t){return c(t.label)}).attr("width",c.rangeBand()).attr("y",function(t){return d(t.value)}).attr("height",function(t){return s-d(t.value)})}function drawMap(t){var a=a||window.parent.snowball,e=a.pluginsUrl+"/lib/d3-geomap",n=t.find(".json-usa").val(),o=t.find(".map").get(0),r=parseInt(t.find("input.quantize").val()),l=t.find("input.color").val(),i=colorbrewer[l][r],s=t.find(".map-type").val(),c=e+"/topojson/countries/USA.json",d=d3.geo.albersUsa,p=800;if("world"===s&&(n=t.find(".json-world").val(),c=e+"/topojson/world/countries.json",d=d3.geo.equirectangular,p=100),n){t.find(".map").empty();var f=d3.geomap.choropleth().geofile(c).projection(d).column("Value").unitId("fips").scale(p).translate([400,200]).colors(i).legend(!0),u=d3.select(o).datum(JSON.parse(n)).call(f.draw,f).select("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 500 400");u.select("rect").style("fill","none")}}function drawScatterplot(t){var a=t.find(".json").val();if(a){var e=t.find(".chart").get(0),n=t.find(".size").val(),o=t.find(".chart").attr("data-fill"),r=JSON.parse(a),l=[],i=[],s=[];r.forEach(function(t){l.push([t.X,t.Y]),i.push(t.X),s.push(t.Y)});var c={top:40,right:40,bottom:60,left:60},d=800-c.left-c.right,p=400-c.top-c.bottom,f=d3.scale.linear().domain([0,d3.max(i)]).range([0,d]),u=d3.scale.linear().domain([0,d3.max(s)]).range([p,0]),h=d3.select(e).append("svg:svg").attr("width",d+c.right+c.left).attr("height",p+c.top+c.bottom).attr("class","chart"),m=h.append("g").attr("transform","translate("+c.left+","+c.top+")").attr("width",d).attr("height",p).attr("class","main"),w=d3.svg.axis().scale(f).orient("bottom");m.append("g").attr("transform","translate(0,"+p+")").attr("class","main axis date").call(w);var g=d3.svg.axis().scale(u).orient("left");m.append("g").attr("transform","translate(0,0)").attr("class","main axis date").call(g),m.selectAll("path, line").style("fill","none").style("stroke","black");var b=m.append("svg:g");b.selectAll("scatter-dots").data(s).enter().append("svg:circle").style("fill",o).attr("cy",function(t){return u(t)}).attr("cx",function(t,a){return f(i[a])}).attr("r",n)}}function createTweet(t){var a=t.find(".tweet").empty(),e=a.attr("data-id");if(e){var n=a.attr("data-theme"),o=a.attr("data-linkColor"),r=a.attr("data-cards")?a.attr("data-cards"):"show",l=a.attr("data-conversation")?a.attr("data-conversation"):"show";twttr.widgets.createTweet(e,a[0],{theme:n,linkColor:o,cards:r,conversation:l,align:"center"})}}!function(t){t(document).ready(function(){var a=t(".snowball-block-bargraph");a.each(function(){drawBargraph(t(this))})})}(jQuery),function(t){t(document).ready(function(){var a=t(".snowball-block-choropleth");a.each(function(){drawMap(t(this))})})}(jQuery),function(t){t(document).ready(function(){t("body").on("click",".snowball-block-contact .submit",function(){var a=t(this).closest("form"),e=a.find("[name='to']").val(),n=a.find("[name='subject']").val(),o=a.find("[name='confirmation']").val(),r="",l=a.find("input, textarea").not("[type='hidden']");l.each(function(){var a=t(this).val();r=t(this).attr("name")?r+"\n\n"+t(this).attr("name")+": "+a:r+"\n\n"+a});var i={action:"mail_before_submit",to:e,subject:n,message:r};window.parent&&(snowball=window.parent.snowball),jQuery.post(snowball.adminUrl+"admin-ajax.php",i,function(t){a.text(o)})})})}(jQuery),function(t){t(document).ready(function(){t(".snowball-block-imageslider .left").css("width","50%")}),t(document).on("mousemove",".snowball-block-imageslider .wrapper",function(a){var e=t(this).closest(".snowball-block"),n=e.find(".left")[0],o=e.find("img")[0],r=e.find(".label-left"),l=e.find(".label-right"),i=o.getBoundingClientRect(),s=(a.pageX-i.left)/i.width*100;s<=100&&(n.style.width=s+"%",s<=20?r.hide():r.show(),s>=80?l.hide():l.show())})}(jQuery),function(t){t(document).ready(function(){var a=t(".snowball-block-scatterplot");a.each(function(){drawScatterplot(t(this))})})}(jQuery),function(t){t(document).ready(function(){t("body").on("click",".snowball-block-share .button",function(){var t,a=a||window.parent.snowball,e=jQuery(this),n=500,o=400,r=screen.width/2-n/2,l=screen.height/2-o/2,i="toolbar=0,status=0,width="+n+",height="+o+",top="+l+",left="+r;t=e.hasClass("facebook")?"http://www.facebook.com/sharer.php?u="+encodeURIComponent(a.url):e.hasClass("twitter")?"http://twitter.com/share?url="+encodeURIComponent(a.url)+"&text="+encodeURIComponent(a.title):e.hasClass("tumblr")?"https://www.tumblr.com/widgets/share/tool?posttype=link&canonicalUrl="+encodeURIComponent(a.url)+"&title="+encodeURIComponent(a.title)+"&content="+encodeURIComponent(a.excerpt):"https://plus.google.com/share?url="+encodeURIComponent(a.url),window.open(t,"share",i)})})}(jQuery),function(t){if(t(".snowball-block-twitter").length>0){var a="https://platform.twitter.com/widgets.js";t.getScript(a,function(){t(".snowball-block-twitter").each(function(){createTweet(t(this))})})}}(jQuery);
//# sourceMappingURL=templates.min.js.map
